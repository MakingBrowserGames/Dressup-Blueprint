var Option=function(a,b,c,d){Kiwi.GameObjects.Sprite.call(this,a,b,c,d)};Kiwi.extend(Option,Kiwi.GameObjects.Sprite),Option.prototype.reset=function(){this.cellIndex=0},Option.prototype.next=function(){this.animation.nextFrame()},Option.prototype.prev=function(){this.animation.prevFrame()},Option.prototype.randomize=function(){this.cellIndex=this.game.rnd.integerInRange(0,this.animation.length)};var MainLoader=new KiwiLoadingScreen("MainLoader","MainMenu","assets/img/loading/");MainLoader.preload=function(){KiwiLoadingScreen.prototype.preload.call(this),this.addSpriteSheet("cameraBtn","assets/img/buttons/cameraBtn.png",100,100),this.addSpriteSheet("randomBtn","assets/img/buttons/randomBtn.png",100,100),this.addSpriteSheet("resetBtn","assets/img/buttons/resetBtn.png",100,100),this.addSpriteSheet("nextBtn","assets/img/buttons/nextBtn.png",63,63),this.addSpriteSheet("prevBtn","assets/img/buttons/prevBtn.png",63,63),this.addSpriteSheet("backBtn","assets/img/buttons/backBtn.png",100,100),this.addSpriteSheet("printBtn","assets/img/buttons/printBtn.png",100,100),this.addSpriteSheet("saveBtn","assets/img/buttons/saveBtn.png",100,100),this.addImage("spinnerBackground","assets/img/spinner/spinnerSquare.png"),this.addImage("spinner","assets/img/spinner/spinner.png")};var MainMenu=new Kiwi.State("MainMenu");MainMenu.create=function(){this.game.stage.color="fff",this.game.states.switchState("Play")};var Play=new Kiwi.State("Play");Play.preload=function(){this.addSpriteSheet("head","assets/img/character/head.png",150,117,!1),this.addSpriteSheet("chest","assets/img/character/chest.png",150,117,!1),this.addSpriteSheet("arms","assets/img/character/arms.png",150,117,!1),this.addSpriteSheet("legs","assets/img/character/legs.png",150,117,!1),this.createLoader()},Play.createLoader=function(){this.spinnerBackground=new Kiwi.GameObjects.StaticImage(this,this.textures.spinnerBackground),this.addChild(this.spinnerBackground),this.spinner=new Kiwi.GameObjects.StaticImage(this,this.textures.spinner),this.addChild(this.spinner),this.spinnerBackground.x=.5*(this.game.stage.width-this.spinnerBackground.width),this.spinner.x=.5*(this.game.stage.width-this.spinner.width),this.spinnerBackground.y=.5*(this.game.stage.height-this.spinnerBackground.height),this.spinner.y=.5*(this.game.stage.height-this.spinner.height)},Play.loadUpdate=function(){this.spinner.rotation+=Math.PI/6},Play.removeLoader=function(){this.spinnerBackground.exists=!1,this.spinner.exists=!1,this.spinnerBackground=null,this.spinner=null},Play.create=function(){this.removeLoader(),this.createDressup(),this.createButtons()},Play.createDressup=function(){this.dressUpElements=[],this.dressUpElements.push(new Option(this,this.textures.legs,100,80)),this.dressUpElements.push(new Option(this,this.textures.chest,100,80)),this.dressUpElements.push(new Option(this,this.textures.arms,100,80)),this.dressUpElements.push(new Option(this,this.textures.head,100,80)),this.buttons=[];for(var a=70*(this.dressUpElements.length-1),b=0;b<this.dressUpElements.length;b++){var c=this.dressUpElements[b],d=new Kiwi.GameObjects.Sprite(this,this.textures.nextBtn,273,a-70*b);d.input.onUp.add(c.next,c),this.buttons.push(d);var e=new Kiwi.GameObjects.Sprite(this,this.textures.prevBtn,0,a-70*b);e.input.onUp.add(c.prev,c),this.buttons.push(e),this.addChild(d),this.addChild(e),this.addChild(c)}},Play.createButtons=function(){this.randomButton=new Kiwi.GameObjects.Sprite(this,this.textures.randomBtn,0,289),this.addChild(this.randomButton),this.randomButton.input.onUp.add(this.randomizeCharacter,this),this.resetButton=new Kiwi.GameObjects.Sprite(this,this.textures.resetBtn,118,289),this.addChild(this.resetButton),this.resetButton.input.onUp.add(this.resetCharacter,this),this.showButton=new Kiwi.GameObjects.Sprite(this,this.textures.cameraBtn,235,289),this.addChild(this.showButton),this.showButton.input.onUp.add(this.showCharacter,this)},Play.randomizeCharacter=function(){for(var a=0;a<this.dressUpElements.length;a++)this.dressUpElements[a].randomize()},Play.resetCharacter=function(){for(var a=0;a<this.dressUpElements.length;a++)this.dressUpElements[a].reset()},Play.showCharacter=function(){};var ShowState=new Kiwi.State("ShowState");ShowState.create=function(a){if(this.printing=!1,this.capturing=!1,this.characterParts=a,void 0!=a)for(var b in a)this[b]=new Kiwi.GameObjects.Sprite(this,this.textures[b],100,80),this.addChildAt(this[b],0),this[b].animation.switchTo(a[b]);this.printButton=new Kiwi.GameObjects.Sprite(this,this.textures.PrintBtn,0,289),this.addChild(this.printButton),this.printButton.input.onUp.add(this.printImg,this),this.saveButton=new Kiwi.GameObjects.Sprite(this,this.textures.SaveBtn,118,289),this.addChild(this.saveButton),this.saveButton.input.onUp.add(this.saveImg,this),this.backButton=new Kiwi.GameObjects.Sprite(this,this.textures.BackBtn,235,289),this.addChild(this.backButton),this.backButton.input.onUp.add(this.goBack,this)},ShowState.printImg=function(){this.printButton.visible=!1,this.saveButton.visible=!1,this.backButton.visible=!1,this.printing=!0},ShowState.saveImg=function(){this.printButton.visible=!1,this.saveButton.visible=!1,this.backButton.visible=!1,this.capturing=!0},ShowState.postRender=function(){if(this.printing){var a=this.game.stage.canvas.toDataURL(),b="<!DOCTYPE html>";b+="<html>",b+="<head><title>Your Dress Up</title></head>",b+="<body>",b+='<img src="'+a+'">',b+="</body>",b+="</html>";var c=window.open("","","width=1280,height=960");c.document.open(),c.document.write(b),c.document.close(),c.focus(),c.print(),c.close(),this.printButton.visible=!0,this.saveButton.visible=!0,this.backButton.visible=!0,this.printing=!1}if(this.capturing){var d=this.game.stage.canvas.toDataURL("image/octet-stream");window.open(d,"toDataURL() image","width=1280, height=960"),this.printButton.visible=!0,this.saveButton.visible=!0,this.backButton.visible=!0,this.capturing=!1}},ShowState.goBack=function(){game.states.switchState("PlayState",PlayState,null,{characterParts:this.characterParts})};var game=new Kiwi.Game("content","DressUpBlueprint");game.states.addState(MainLoader),game.states.addState(MainMenu),game.states.addState(Play),game.states.switchState("MainLoader");